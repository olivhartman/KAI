# KAI AI INFLUENCER - GOOGLE SHEETS SYSTEM DOCUMENTATION

## ðŸ“‹ Overview

This system consists of 6 interconnected spreadsheets that serve as the command center for KAI's daily content automation across multiple social media platforms.

---

## ðŸ“Š SPREADSHEET BREAKDOWN

### 1. **Master Control & F1 Research Log**
**Purpose:** Central hub for daily F1 research and race schedule tracking

**Key Sections:**

#### A. Daily Research Log
- **What it tracks:** Daily trending F1 topics from Perplexity AI research
- **Status values:** PENDING â†’ RESEARCHING â†’ COMPLETED â†’ ASSIGNED
- **Trending Score:** 1-10 rating to prioritize content creation
- **Workflow Assignment:** Links research to specific content workflows

**How n8n uses it:**
1. Daily trigger (6 AM) creates new row with PENDING status
2. Perplexity API node queries latest F1 news
3. Fills in: Topic, Trending Score, Source URLs, Key Points, Content Ideas
4. Status changes to COMPLETED
5. High-priority topics (8-10) auto-trigger content workflows

#### B. Race Calendar & Triggers
- **What it tracks:** F1 race weekend schedule + automated content triggers
- **Content Trigger (+6hrs):** Auto-calculated datetime 6 hours after race/qualifying
- **Auto-Generate:** YES/NO flag to enable automated content creation

**How n8n uses it:**
- Cron trigger checks this sheet every hour
- When current time matches "Content Trigger (+6hrs)" AND Auto-Generate = YES
- Triggers long-form reaction video workflow about that race
- Updates Status to TRIGGERED

**Key Columns:**
- `H` (Content Trigger): Formula adds 6 hours to Race Date/Time
- `I` (Auto-Generate): Manual YES/NO flag
- `J` (Status): SCHEDULED â†’ TRIGGERED â†’ COMPLETED

---

### 2. **YouTube Long-Form Tracker**
**Purpose:** Manages daily reaction videos from script to publication

**Main Workflow Columns:**

| Column | Field | Purpose | Status Flow |
|--------|-------|---------|-------------|
| A | Video ID | Unique identifier (YT001, YT002...) | Auto-generated |
| B | Publish Date | Target publish date | Set by workflow |
| C | Status | Current workflow stage | DRAFT â†’ SCRIPT_READY â†’ GENERATING â†’ MERGING â†’ READY_TO_PUBLISH â†’ PUBLISHED â†’ ERROR |
| D | Topic/Title | Video subject from research | From Master Control |
| E | Video Type | Reaction/Analysis/Breaking News | Auto-determined |
| F | Wardrobe Selected | Which outfit to use | Auto-selected from Asset Library |
| G | Emotion/Mood | KAI's reaction type | From script generation |
| H | Script Generated | Full video script | Generated by Deepseek/Anthropic |
| I | Intro Clip URL | 5s intro from R2 | Fixed asset |
| J | Main Content URLs | Generated video clips (comma-separated) | From Sora2/KIE.ai |
| K | Outro Clip URL | 5s outro from R2 | Fixed asset |
| L | Merged Video URL | Final merged MP4 from FAL.ai | Post-merge |
| M | Thumbnail URL | Auto-generated thumbnail | From image gen |
| N | SEO Title | YouTube-optimized title | From AI generation |
| O | Description | Video description with timestamps | Generated |
| P | Tags | YouTube tags/hashtags | Generated |
| Q | YouTube URL | Published video URL | After upload |
| R | Comment Posted | YES/NO - CTA comment status | After publish |
| S | CTA URL | Link for pinned comment | Fixed or custom |
| T | Error Log | Any errors during workflow | For debugging |

**n8n Workflow Steps:**
1. **Trigger:** New row added with Status = DRAFT (from Master Control)
2. **Script Generation:** 
   - Read Topic, Research Key Points from Master Control
   - Call Deepseek API with character bible context
   - Generate 5-10 min reaction script
   - Update Status â†’ SCRIPT_READY
3. **Wardrobe Selection:**
   - Parse Team/Driver from topic
   - Query Asset Library > Wardrobe sheet
   - Match Auto-Select Rule (e.g., "IF team=Ferrari AND result=WIN")
   - Store wardrobe URL
4. **Video Generation:**
   - Status â†’ GENERATING
   - Break script into 3-5 scene segments
   - For each segment:
     - Combine: Character Ref + Studio Background + Selected Wardrobe + Emotion
     - Call Sora2 API with prompt
     - Store generated clip URL in column J
5. **Video Merging:**
   - Status â†’ MERGING
   - Collect: Intro URL (column I) + Main clips (J) + Outro URL (K)
   - Upload all to FAL.ai merge API
   - Receive merged video URL
   - Store in column L
   - Status â†’ READY_TO_PUBLISH
6. **Thumbnail Generation:**
   - Extract frame from merged video OR
   - Generate custom thumbnail with KIE.ai
   - Store URL in column M
7. **YouTube Upload:**
   - When Status = READY_TO_PUBLISH
   - Upload merged video via YouTube API
   - Use SEO Title (N), Description (O), Tags (P)
   - Get published URL
   - Store in column Q
   - Status â†’ PUBLISHED
8. **Comment Posting:**
   - Wait 30 seconds after publish
   - Post comment with CTA URL (S)
   - Pin comment via YouTube API
   - Update Comment Posted â†’ YES

**Error Handling:**
- Any API failure â†’ Status = ERROR
- Log error message in column T
- Send Telegram notification to admin

---

### 3. **Short-Form Multi-Platform Tracker**
**Purpose:** Distribute 30-60s clips to Instagram, TikTok, Twitter, Telegram, YouTube Shorts

**Key Concept:** Short clips are extracted from long-form videos (not generated separately)

**Main Columns:**

| Column | Field | Purpose |
|--------|-------|---------|
| A | Short ID | Unique ID (SHORT001, SHORT002...) |
| B | Source Video ID | Links to YouTube Long-Form Video ID |
| C | Created Date | When clip was extracted |
| D | Status | EXTRACTING â†’ READY_TO_POST â†’ POSTING â†’ POSTED â†’ ERROR |
| E | Clip Title | Short, punchy title |
| F | Clip Duration | 30-60 seconds |
| G | Portrait Video URL | 9:16 aspect ratio version in R2 |
| H | Thumbnail URL | Cover image for platforms |
| I | Caption | Platform-optimized caption |
| J | Hashtags | Platform-specific tags |
| K-O | Platform Status | Individual status per platform |
| P | Engagement Count | Total views/likes across platforms |
| Q | Best Performer | Which platform got most engagement |

**n8n Workflow:**
1. **Trigger:** YouTube Long-Form video Status changes to PUBLISHED
2. **Clip Extraction:**
   - Download merged video from column L (YouTube tracker)
   - Use FFmpeg to extract best 45-second segment (most engaging part)
   - Crop to 9:16 portrait (1080x1920)
   - Upload to R2 storage
   - Store URL in column G
   - Status â†’ READY_TO_POST
3. **Caption Generation:**
   - Take original video title + key points
   - Generate short, hook-based caption
   - Platform-specific: Twitter (shorter), Instagram (more hashtags)
4. **Multi-Platform Publishing:**
   - **Instagram:** Blotato API â†’ Update column K
   - **TikTok:** Blotato API â†’ Update column L
   - **Twitter:** Blotato API â†’ Update column M
   - **Telegram:** Telegram Bot API â†’ Update column N
   - **YouTube Shorts:** Direct YouTube API â†’ Update column O
5. **Status Updates:** Each platform column gets:
   - PENDING â†’ POSTING â†’ POSTED (with timestamp) OR ERROR

**Best Practice:**
- Extract clip from most emotional/engaging moment (timestamps can be AI-analyzed)
- Use different hooks for each platform while keeping video same
- Schedule posts 2-4 hours apart across platforms

---

### 4. **Single Image Posts Tracker**
**Purpose:** Daily infographic or fact posts (not lifestyle)

**Content Types:**
- Infographics (F1 stats, records, comparisons)
- Historical facts (This day in F1 history)
- Technical explainers (How DRS works, illustrated)

**Main Columns:**

| Column | Field | Purpose |
|--------|-------|---------|
| A | Image ID | Unique ID (IMG001, IMG002...) |
| B | Post Date | When to publish |
| C | Status | IDEA â†’ GENERATING â†’ READY_TO_POST â†’ POSTED â†’ ERROR |
| D | Content Type | Infographic/Fact/Explainer |
| E | Topic/Fact | What the post is about |
| F | Image URL | R2 storage URL |
| G | Caption | Post text |
| H | Hashtags | Platform tags |
| I-K | Platform Status | Twitter, Instagram, Telegram |
| L | Generation Prompt | Full prompt used for image gen |
| M | Character Ref Used | Which KAI image was included |
| N | Total Engagement | Aggregate performance |

**n8n Workflow:**
1. **Daily Trigger:** 7 AM creates new row with IDEA status
2. **Topic Selection:**
   - Query Master Control for F1 facts/history
   - OR use Perplexity to find "interesting F1statistic"
   - Store in column E
3. **Prompt Creation:**
   - Generate detailed image prompt combining:
     - Infographic layout instructions
     - F1 topic/data
     - KAI character placement (corner or side)
     - Brand colors/style
   - Store in column L
4. **Image Generation:**
   - Status â†’ GENERATING
   - Call KIE.ai image API with prompt
   - Download generated image
   - Upload to R2 storage
   - Store URL in column F
5. **Caption Generation:**
   - Use AI to create engaging caption from topic
   - Add relevant hashtags
   - Store in columns G, H
6. **Publishing:**
   - Status â†’ READY_TO_POST
   - Post via Blotato to Twitter, Instagram
   - Post via Telegram Bot to channel
   - Update platform status columns
   - Status â†’ POSTED

---

### 5. **Multi-Image Carousel Tracker**
**Purpose:** Lifestyle content with 3-5 images per post

**Content Types:**
- "Day in the life" sequences
- Race weekend morning routines
- Watch party setups
- Outfit of the day

**Key Difference from Single Image:**
- Multiple coordinated images (3-5)
- Tells a story through sequence
- More personal/behind-the-scenes vibe

**Main Columns:**

| Column | Field | Purpose |
|--------|-------|---------|
| A | Carousel ID | Unique ID (CAROUSEL001...) |
| B | Post Date | Publish date |
| C | Status | PLANNING â†’ GENERATING â†’ READY_TO_POST â†’ POSTED |
| D | Theme | Overall story/concept |
| E-I | Image URLs | 5 image slots (3 minimum) |
| J | Caption | Story caption |
| K | Hashtags | Tags |
| L-O | Platform Status | Twitter, Instagram, TikTok, Telegram |

**n8n Workflow:**
1. **Content Planning:**
   - Daily trigger creates theme idea (e.g., "Getting ready for Monaco GP")
   - Define 3-5 image sequence
2. **Image Generation:**
   - For each image in sequence:
     - Generate prompt (maintain consistency across images)
     - Different wardrobe selections from Asset Library
     - Different poses/moods but same character
     - Call KIE.ai for each image
     - Upload to R2
     - Store URLs in columns E-I
3. **Publishing:**
   - Use Blotato multi-image API for Instagram carousel
   - For Twitter: Thread with images
   - For Telegram: Media group
   - TikTok: Slideshow format

---

### 6. **Asset Library Index**
**Purpose:** Centralized reference for all reusable assets stored in R2

**3 Sheets in this workbook:**

#### Sheet 1: Character References
Stores multiple moods/expressions of KAI for image/video generation

**Columns:**
- Asset ID: CHAR001, CHAR002...
- File Name: kai_happy.png, kai_shocked.png
- R2 URL: Direct link for API calls
- Mood/Expression: Happy, Shocked, Thinking, Neutral
- Pose Type: Front-facing, Side profile, etc.
- Use Case: When to use this reference
- Status: ACTIVE/ARCHIVED

**How n8n uses it:**
- Video generation workflows query this sheet
- Match required emotion â†’ get character ref URL
- Pass URL to Sora2/image gen API for consistency

#### Sheet 2: Wardrobe Library
15 pre-generated outfit variations linked to F1 teams/events

**Columns:**
- Wardrobe ID: WARD001, WARD002...
- Outfit Name: "Red Bull Racing Shirt", "Ferrari Cap"
- R2 URL: Image of outfit  https://pub-b950cb87774b4e2eb3b2293cea84bafe.r2.dev
- Team/Brand: Which F1 team
- Auto-Select Rule: Logic for automation
  - Example: `IF team=McLaren AND result=WIN`
  - Example: `IF content_type=preview`
- Status: ACTIVE/SEASONAL

**Auto-Selection Logic:**
```
IF topic contains "McLaren wins" â†’ Select WARD003 (McLaren shirt)
IF topic contains "Ferrari pole" â†’ Select WARD002 (Ferrari outfit)
IF no team match â†’ Select WARD005 (Generic F1 fan tee)
```

**How to add new wardrobe:**
1. Generate outfit image with KIE.ai
2. Upload to R2: `https://r2.kai.ai/wardrobe/aston_martin.png`
3. Add new row with Auto-Select Rule
4. Status = ACTIVE

#### Sheet 3: Props & Studio
Background scenes and props for video generation

**Asset Types:**
- **Studio Background:** KAI's bedroom YouTube studio
- **Props:** Headphones, water bottle, coffee mug, phone
- **Category:** Background/Props/Furniture

**How n8n uses it:**
- Long-form video generation always includes:
  - Studio Background (PROP001) as base scene
  - Headphones (PROP002) for reaction videos
  - Dynamic prop based on content type
- Query this sheet â†’ pass URLs to video gen API

---

## ðŸ”„ WORKFLOW AUTOMATION LOGIC

### Daily Automation Schedule

**6:00 AM** - F1 Research
- n8n reads Master Control sheet
- Creates new row with today's date
- Calls Perplexity API: "Latest F1 news, breaking stories, trending topics"
- Fills in research data
- High-priority topics (score 8-10) trigger content creation

**7:00 AM** - Single Image Post
- Creates new row in Single Image tracker
- Generates infographic/fact post
- Posts to Twitter, Instagram, Telegram

**12:00 PM** - Multi-Image Carousel
- Creates lifestyle content
- Posts to Instagram, TikTok

**Race Weekend (+6 hours after event)** - Long-Form Video
- Triggered automatically from Race Calendar
- Generates reaction video
- Publishes to YouTube
- Posts comment with CTA

**+2 hours after YouTube publish** - Short Clips
- Extracts clips from long-form
- Distributes to all short-form platforms

---

## ðŸ“ GOOGLE SHEETS SETUP INSTRUCTIONS

### Step 1: Upload to Google Drive
1. Upload all 6 .xlsx files to your Google Drive
2. Convert each to Google Sheets format:
   - Right-click file â†’ Open with â†’ Google Sheets
   - File â†’ Save as Google Sheets

### Step 2: Share with n8n Service Account
1. In n8n, go to Credentials â†’ Google Sheets OAuth2
2. Note the service account email
3. Share each sheet with this email (Editor access)

### Step 3: Get Sheet IDs
For each Google Sheet:
1. Open the sheet
2. Copy the ID from URL: `docs.google.com/spreadsheets/d/{SHEET_ID}/edit`
3. Store these IDs in n8n workflow settings:
   - `MASTER_CONTROL_SHEET_ID`
   - `LONGFORM_SHEET_ID`
   - `SHORTFORM_SHEET_ID`
   - `SINGLE_IMAGE_SHEET_ID`
   - `MULTI_IMAGE_SHEET_ID`
   - `ASSET_LIBRARY_SHEET_ID`

### Step 4: Set Up Named Ranges (Optional but Recommended)
Makes n8n formulas cleaner:
1. Select research log data range (A4:M100)
2. Data â†’ Named ranges â†’ Create "ResearchLog"
3. Repeat for other key ranges

---

## ðŸ› ï¸ N8N INTEGRATION PATTERNS

### Pattern 1: Read Latest Research
```
Google Sheets Node (Read)
- Sheet: Master Control
- Range: A:M
- Filter: Status = COMPLETED
- Sort: Date DESC
- Limit: 1
```

### Pattern 2: Update Video Status
```
Google Sheets Node (Update)
- Sheet: YouTube Long-Form
- Range: C4 (Status column for row 4)
- Value: PUBLISHED
```

### Pattern 3: Auto-Select Wardrobe
```
Code Node:
const topic = $input.item.json.topic.toLowerCase();
const wardrobeSheet = $('Get Wardrobe').all();

let selectedWardrobe = wardrobeSheet.find(row => {
  const rule = row.json['Auto-Select Rule'].toLowerCase();
  // Simple rule matching
  if (topic.includes('mclaren') && rule.includes('mclaren')) return true;
  if (topic.includes('ferrari') && rule.includes('ferrari')) return true;
  return false;
}) || wardrobeSheet.find(row => row.json['Auto-Select Rule'] === 'DEFAULT');

return {
  wardrobeUrl: selectedWardrobe.json['R2 Storage URL'],
  wardrobeName: selectedWardrobe.json['Outfit Name']
};
```

---

## ðŸ“Š STATUS VALUE REFERENCE

### Universal Status Flow
```
DRAFT â†’ GENERATING â†’ READY_TO_POST â†’ POSTING â†’ POSTED â†’ [ARCHIVED]
                                                â†“
                                              ERROR
```

### Platform-Specific Status
For multi-platform tracking (columns K-O in various sheets):
- `PENDING` - Not yet attempted
- `POSTING` - API call in progress
- `POSTED - 2026-02-10 14:30` - Success with timestamp
- `ERROR: API timeout` - Failure with reason
- `SKIPPED` - Manually skipped this platform

---

## ðŸŽ¯ NEXT STEPS

Now that you have the sheet structure, here's what we'll build next:

1. **Workflow 1: Daily F1 Research** (Foundation for all content)
   - Perplexity integration
   - Topic scoring algorithm
   - Auto-assignment to content types

2. **Workflow 2: Single Image Generator** (Simplest to start)
   - KIE.ai image generation
   - Multi-platform posting
   - Status tracking

3. **Workflow 3: Long-Form YouTube** (Most complex)
   - Script generation
   - Video generation with Sora2
   - FAL.ai merging
   - YouTube upload + comment

4. **Workflow 4: Short Clips Extractor** (Depends on #3)
   - FFmpeg clip extraction
   - Multi-platform distribution

5. **Workflow 5: Multi-Image Carousel** (Similar to #2)
   - Sequential image generation
   - Carousel posting

Would you like me to start building the n8n JSON workflow for **Daily F1 Research** first? This is the foundation that feeds all other workflows.
